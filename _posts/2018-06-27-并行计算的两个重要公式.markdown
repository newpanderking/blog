---
layout: post
title:  "并行计算的两个重要公式"
date:   2018-06-27 18:18:45
categories: 技术
tags: 多线程
description: 并行计算的两个重要公式，安达尔定律&古斯塔夫森定律
---

## Amdahl（安达尔）定律
> 加速比 = 优化前系统耗时 / 优化后系统耗时


$$
T_n = T_1*(F+\frac{1}{n}(1-F))      -----         (1)
$$

其中n表示有`n`个处理器，`T`表示时间，`T_1`表示优化前的耗时，也就是一个处理器的耗时，`T_n`表示使用`n`个处理器优化后的耗时, `F`为程序中只能进行串行的执行比例。因此可以将:

$$
  加速比 = \frac{T_1(优化前耗时)}{T_n(优化后耗时)}
$$

带入以上公式可以推导为：

$$
... = \frac{T_1}{T_1*(F+\frac{1}{n}(1-F))}----(2)
$$

$$
... = \frac{1}{F+\frac{1}{n}(1-F)}----(3)
$$

根据以上公式可以看出，如果CPU处理器数量趋于无穷，那么加速比与系统的串行化率成反比，如果系统中必须有50%的代码进行串行执行，那么系统的最大加速比为2。从以上的公式中就可以看出，仅仅依靠增加CPU的数量并不一定能够起到有效的作用。需要从根本上修改程序的穿性行为，提高系统内可以并行优化的模块比重，在此基础之上，合理的增加并行处理器的数量，才能够以最小的投入，得到最大的加速比。

## Gustafson（古斯塔夫森）定律
> 加速比 = 优化前系统耗时 / 优化后系统耗时

$$
优化前执行时间:a(串行时间)+n*b(并行时间)
$$

$$
优化后执行时间:a(串行时间)+b(并行时间)
$$

`a`串行执行时间; `b`单处理器执行时间; `n`系统内核数目。

$$
加速比 = \frac{a+n*b}{a+b}
$$

$$
串行比例:F = \frac{a}{a+b}
$$

那么

$$
加速比 = \frac{a+n*b}{a+b} = \frac{a}{a+b}+\frac{n*b}{a+b}
$$

$$
加速比 = F + n*\frac{a+b-a}{a+b} = F + n*(1-\frac{a}{a+b})=F+n*(1-F)
$$

$$
加速比 = F+n*(1-F) = F + n - n*F = n - F*(n-1)
$$

由此公式可知，当`F`极小，也就是串行化比例极小时，加速比和处理器的内核数目成正比，越多的加速器就能获取越多的加速比例。

